-- | ignore

import "qr"

module block_householder = mk_block_householder f64
entry test_householder = block_householder.qr 1

module gram_schmidt = mk_gram_schmidt f64
entry test_gram_schmidt = gram_schmidt.qr

-- ==
-- entry: test_householder
-- input {
-- [[4.0, 1.0, -2.0, 2.0],
-- [1.0, 2.0, 0.0, 1.0],
-- [-2.0, 0.0, 3.0, -2.0],
-- [2.0, 1.0, -2.0, -1.0]] }
-- output {
-- [[0.8, -0.150966, 0.577499, 6.0858e-2], [0.2, 0.905795, -7.875e-2, 0.365148],
-- [-0.4, 0.345065, 0.695624, -0.486865],[0.4, 0.194099, -0.42, -0.791155]]
-- [[5.0, 1.6, -3.6, 2.2], [0.0, 1.854724, 0.948928, -0.280365],
-- [0.0, 0.0, 1.771874, 0.104999], [0.0, 0.0, -0.0, 2.251749]] }
-- compiled input {
-- [[4.0, 1.0, -2.0, 2.0],
-- [1.0, 2.0, 0.0, 1.0],
-- [-2.0, 0.0, 3.0, -2.0],
-- [2.0, 1.0, -2.0, -1.0]] }
-- output {
-- [[0.8, -0.150966, 0.577499, 6.0858e-2], [0.2, 0.905795, -7.875e-2, 0.365148],
-- [-0.4, 0.345065, 0.695624, -0.486865],[0.4, 0.194099, -0.42, -0.791155]]
-- [[5.0, 1.6, -3.6, 2.2], [0.0, 1.854724, 0.948928, -0.280365],
-- [0.0, 0.0, 1.771874, 0.104999], [0.0, 0.0, -0.0, 2.251749]] }
-- compiled input {
-- [[8.6, 6.8, 8.4, 4.1, 7.1, 6.2],
-- [1.8, 6.1, 4.2, 3.4, 2.0, 1.3],
-- [2.3, 0.3, 5.3, 4.3, 5.2, 4.5],
-- [6.6, 0.4, 1.0, 4.0, 7.7, 7.2],
-- [2.2, 0.9, 1.3, 0.3, 8.1, 2.5],
-- [6.1, 3.9, 0.5, 8.5, 8.3, 0.3]] }
-- output {
-- [[0.663307, 0.271432, 0.317085, -0.462227, -0.252082, -0.329555],
-- [0.138832, 0.779029, -1.9064e-2, 0.169332, 0.117533, 0.575316],
-- [0.177396, -0.161922, 0.741335, 0.620826, 8.549e-2, 8.22e-4],
-- [0.50905, -0.535816, -0.147713, -9.7821e-2, -8.6074e-2, 0.644183],
-- [0.169683, -6.0211e-2, 2.9345e-2, -0.230224, 0.952083, -8.5186e-2],
-- [0.470485, 4.9951e-2, -0.571695, 0.556486, 3.8234e-2, -0.371719]]
-- [[12.965338, 7.601807, 8.059951, 10.040617, 15.108746, 9.321777],
-- [0.0, 6.475533, 4.10465, 1.328565, -1.555666, -2.026452],
-- [0.0, -0.0, 6.117109, -1.018484, 0.423355, 4.115473],
-- [0.0, -0.0, 0.0, 5.619929, 2.285944, -0.964883],
-- [-0.0, -0.0, 0.0, -0.0, 6.256272, 0.746534],
-- [-0.0, 1.0e-6, 0.0, -0.0, 0.0, 3.022006]] }
-- compiled input {
-- [[8.6, 6.8, 8.4, 4.1, 7.1, 6.2],
-- [1.8, 6.1, 4.2, 3.4, 2.0, 1.3],
-- [2.3, 0.3, 5.3, 4.3, 5.2, 4.5],
-- [6.6, 0.4, 1.0, 4.0, 7.7, 7.2],
-- [2.2, 0.9, 1.3, 0.3, 8.1, 2.5],
-- [6.1, 3.9, 0.5, 8.5, 8.3, 0.3]] }
-- output {
-- [[0.663307, 0.271432, 0.317085, -0.462227, -0.252082, -0.329555],
-- [0.138832, 0.779029, -1.9064e-2, 0.169332, 0.117533, 0.575316],
-- [0.177396, -0.161922, 0.741335, 0.620826, 8.549e-2, 8.22e-4],
-- [0.50905, -0.535816, -0.147713, -9.7821e-2, -8.6074e-2, 0.644183],
-- [0.169683, -6.0211e-2, 2.9345e-2, -0.230224, 0.952083, -8.5186e-2],
-- [0.470485, 4.9951e-2, -0.571695, 0.556486, 3.8234e-2, -0.371719]]
-- [[12.965338, 7.601807, 8.059951, 10.040617, 15.108746, 9.321777],
-- [0.0, 6.475533, 4.10465, 1.328565, -1.555666, -2.026452],
-- [0.0, -0.0, 6.117109, -1.018484, 0.423355, 4.115473],
-- [0.0, -0.0, 0.0, 5.619929, 2.285944, -0.964883],
-- [-0.0, -0.0, 0.0, -0.0, 6.256272, 0.746534],
-- [-0.0, 1.0e-6, 0.0, -0.0, 0.0, 3.022006]] }
-- compiled input {
-- [[8.637991, 6.8527875, 8.494828, 4.133455],
-- [7.1377163, 6.2200956, 1.8129241, 6.1604147],
-- [4.2834697, 3.4668689, 2.0822196, 1.3948627],
-- [2.3130302, 0.31626114, 5.3857718, 4.3046875],
-- [5.2128015, 4.5422025, 6.688845, 0.42198926],
-- [1.0653037, 4.018378, 7.7707434, 7.227976],
-- [2.2138827, 0.9177076, 1.3384017, 0.3891652],
-- [8.16692, 2.5744796, 6.1352873, 3.99335]] }
-- output {
-- [[0.547226, 0.187673, 8.9261e-2, -0.269255, 0.12854, 0.701943, 3.4998e-2, 0.272736],
-- [0.452182, 0.264894, -0.575154, 0.490129, 0.220431, -7.903e-2, -4.7743e-2, -0.3118],
-- [0.271362, 0.106588, -0.208484, -0.109951, -0.905224, -0.125084, -0.115308, 0.10523],
-- [0.146533, -0.248895, 0.506506, 0.355381, -0.23998, 0.3087, -0.139433, -0.601172],
-- [0.330236, 0.193369, 0.202675, -0.61711, 0.175909, -0.423024, -0.151181, -0.445984],
-- [6.7488e-2, 0.648184, 0.537463, 0.365887, -2.1117e-2, -0.258776, 0.124628, 0.263857],
-- [0.140252, -0.117088, -7.383e-3, -5.8423e-2, -9.6732e-2, -6.2081e-2, 0.959029, -0.173793],
-- [0.517383, -0.591656, 0.176689, 0.175441, 0.130838, -0.374592, -7.5055e-2, 0.396469]]
-- [[15.78506, 10.78165, 12.917926, 8.804682],
-- [0.0, 5.076869, 3.499527, 3.843255],
-- [0.0, 0.0, 8.615662, 3.388317],
-- [0.0, 0.0, 0.0, 6.344952],
-- [1.0e-6, 0.0, 0.0, 0.0],
-- [0.0, 0.0, 0.0, -0.0],
-- [0.0, -0.0, 0.0, 0.0],
-- [1.0e-6, 0.0, 0.0, 0.0]] }
-- compiled input {
-- [[8.637991, 6.8527875, 8.494828, 4.133455],
-- [7.1377163, 6.2200956, 1.8129241, 6.1604147],
-- [4.2834697, 3.4668689, 2.0822196, 1.3948627],
-- [2.3130302, 0.31626114, 5.3857718, 4.3046875],
-- [5.2128015, 4.5422025, 6.688845, 0.42198926],
-- [1.0653037, 4.018378, 7.7707434, 7.227976],
-- [2.2138827, 0.9177076, 1.3384017, 0.3891652],
-- [8.16692, 2.5744796, 6.1352873, 3.99335]] }
-- output {
-- [[0.547226, 0.187673, 8.9261e-2, -0.269255, 0.12854, 0.701943, 3.4998e-2, 0.272736],
-- [0.452182, 0.264894, -0.575154, 0.490129, 0.220431, -7.903e-2, -4.7743e-2, -0.3118],
-- [0.271362, 0.106588, -0.208484, -0.109951, -0.905224, -0.125084, -0.115308, 0.10523],
-- [0.146533, -0.248895, 0.506506, 0.355381, -0.23998, 0.3087, -0.139433, -0.601172],
-- [0.330236, 0.193369, 0.202675, -0.61711, 0.175909, -0.423024, -0.151181, -0.445984],
-- [6.7488e-2, 0.648184, 0.537463, 0.365887, -2.1117e-2, -0.258776, 0.124628, 0.263857],
-- [0.140252, -0.117088, -7.383e-3, -5.8423e-2, -9.6732e-2, -6.2081e-2, 0.959029, -0.173793],
-- [0.517383, -0.591656, 0.176689, 0.175441, 0.130838, -0.374592, -7.5055e-2, 0.396469]]
-- [[15.78506, 10.78165, 12.917926, 8.804682],
-- [0.0, 5.076869, 3.499527, 3.843255],
-- [0.0, 0.0, 8.615662, 3.388317],
-- [0.0, 0.0, 0.0, 6.344952],
-- [1.0e-6, 0.0, 0.0, 0.0],
-- [0.0, 0.0, 0.0, -0.0],
-- [0.0, -0.0, 0.0, 0.0],
-- [1.0e-6, 0.0, 0.0, 0.0]] }

-- ==
-- entry: test_gram_schmidt
-- input {
-- [[4.0, 1.0, -2.0, 2.0],
-- [1.0, 2.0, 0.0, 1.0],
-- [-2.0, 0.0, 3.0, -2.0],
-- [2.0, 1.0, -2.0, -1.0]] }
-- output {
-- [[0.8, -0.150966, 0.577499, 6.0858e-2], [0.2, 0.905795, -7.875e-2, 0.365148],
-- [-0.4, 0.345065, 0.695624, -0.486865],[0.4, 0.194099, -0.42, -0.791155]]
-- [[5.0, 1.6, -3.6, 2.2], [0.0, 1.854724, 0.948928, -0.280365],
-- [0.0, 0.0, 1.771874, 0.104999], [0.0, 0.0, -0.0, 2.251749]] }
